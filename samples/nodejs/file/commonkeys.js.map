{"version":3,"sources":["commonkeys.es6"],"names":[],"mappings":";;AAAA,IAAI,KAAK,QAAQ,IAAR,CAAT;AAAA,IACE,aAAa,CAAC,SAAD,EAAY,KAAZ,EAAmB,OAAnB,EAA4B,KAA5B,EAAmC,MAAnC,EAA2C,SAA3C,CADf;AAAA,IAEE,oBAAoB,EAFtB;AAAA,IAGE,kBAAkB,EAHpB;;AAKA;;AAEA,SAAS,IAAT,GACA;AACC,qBAAoB,UAApB;;AAEA,mBAAkB,wBAAlB;AACA,gBAAe,EAAf,EAAmB,SAAnB,EAA8B,iBAA9B,EAAiD,eAAjD;AACA;AACA;;AAED,SAAS,mBAAT,CAA6B,UAA7B,EACA;AACC,YAAW,OAAX,CAAmB,UAAU,SAAV,EAAqB;AACvC,MAAI,mBAAmB,wBAAwB,EAAxB,EAA4B,YAAY,IAAZ,GAAmB,SAAnB,GAA+B,IAA3D,EAAiE,iBAAjE,CAAvB;AACA,SAAO,IAAP,CAAY,gBAAZ,EAA8B,OAA9B,CAAsC,UAAU,OAAV,EAAmB;AACxD,OAAI,kBAAkB,cAAlB,CAAiC,OAAjC,CAAJ,EACA;AACC,sBAAkB,OAAlB,EAA2B,OAA3B,KAAuC,CAAvC;AACA,sBAAkB,OAAlB,EAA2B,MAA3B,KAAuC,iBAAiB,OAAjB,MAA8B,kBAAkB,OAAlB,EAA2B,KAAzD,GAAiE,CAAjE,GAAqE,CAA5G;AACA,IAJD,MAMA;AACC,sBAAkB,OAAlB,IAA6B;AAC5B,YAAO,CADqB;AAE5B,WAAM,CAFsB;AAG5B,UAAK,OAHuB;AAI5B,YAAO,iBAAiB,OAAjB,CAJqB;AAK5B,eAAU;AALkB,KAA7B;AAOA;AACD,qBAAkB,OAAlB,EAA2B,UAA3B,EAAuC,SAAvC,IAAoD,iBAAiB,OAAjB,CAApD;AACA,GAjBD;AAkBA,EApBD;AAqBA;;AAED,SAAS,sBAAT,GACA;AACC,KAAI,cAAc,EAAlB;AACA,QAAO,IAAP,CAAY,iBAAZ,EACG,MADH,CACU,UAAU,OAAV,EAAmB;AAC1B,SAAO,kBAAkB,OAAlB,EAA2B,OAA3B,IAAsC,CAA7C;AACA,EAHH,EAGK,GAHL,CAGS,UAAU,OAAV,EAAmB;AAC3B,MAAI,eAAe,kBAAkB,OAAlB,CAAnB;;AAEA,MAAI,aAAa,MAAb,MAAyB,CAA7B,EACA;AACC,eAAY,YAAY,MAAxB,IAAkC;AACjC,SAAK,aAAa,GADe;AAEjC,WAAO,aAAa;AAFa,IAAlC;AAIA,GAND,MAQA;AACC;AACA,eAAY,YAAY,MAAxB,IAAkC;AACjC,SAAK,EAD4B;AAEjC,WAAO;AAF0B,IAAlC;AAIA,UAAO,IAAP,CAAY,aAAa,UAAb,CAAZ,EACG,GADH,CACO,UAAU,SAAV,EAAqB;AACzB,gBAAY,YAAY,MAAxB,IAAkC;AACjC,UAAK,aAAa,GADe;AAEjC,YAAO,aAAa,UAAb,EAAyB,SAAzB;AAF0B,KAAlC;AAIA,IANH;AAOA;AACA,eAAY,YAAY,MAAxB,IAAkC;AACjC,SAAK,EAD4B;AAEjC,WAAO;AAF0B,IAAlC;AAIA;AACD,EAjCD;AAkCA,QAAO,WAAP;AACA;;AAED,SAAS,cAAT,CAAwB,EAAxB,EAA4B,GAA5B,EAAiC,QAAjC,EAA2C,SAA3C,EACA;AACC,KAAI,aAAa,UAAU,GAAV,CAAc,UAAU,QAAV,EAAoB;AAClD,SAAO,wBAAwB,SAAS,GAAjC,EAAsC,SAAS,KAA/C,CAAP;AACA,EAFgB,EAEd,IAFc,CAET,EAFS,CAAjB;AAGA,iBAAgB,EAAhB,EAAoB,YAAY,GAAhC,EAAqC,QAArC,EAA+C,UAA/C;AACA;;AAED,SAAS,uBAAT,CAAiC,OAAjC,EAA0C,KAA1C,EACA;AACC,KAAI,YAAY,EAAZ,IAAkB,UAAU,EAAhC,EACA;AACC,SAAO,IAAP;AACA;AACD,QAAQ,UAAU,GAAV,GAAgB,KAAhB,GAAwB,IAAhC;AACA;;AAED,SAAS,eAAT,CAAyB,EAAzB,EAA6B,GAA7B,EAAkC,QAAlC,EAA4C,IAA5C,EACA;AACC,IAAG,SAAH,CAAa,MAAM,QAAnB,EAA6B,IAA7B,EAAmC,UAAU,GAAV,EAAe;AACjD,MAAI,GAAJ,EACA;AACC,WAAQ,GAAR,CAAY,oBAAZ;AACA,GAHD,MAKA;AACC,WAAQ,GAAR,CAAY,MAAM,GAAN,GAAY,QAAZ,GAAuB,aAAnC;AACA;AACD,EATD;AAUA;;AAED,SAAS,uBAAT,CAAiC,EAAjC,EAAqC,GAArC,EAA0C,QAA1C,EACA;AACC,KAAI,eAAe,GAAG,YAAH,CAAgB,MAAM,QAAtB,EAAgC,QAAhC,EAAnB;AAAA,KACE,oBAAoB,EADtB;AAEA,cAAa,KAAb,CAAmB,IAAnB,EACG,MADH,CACU,UAAU,IAAV,EAAgB;AACvB,SAAO,KAAK,IAAL,GAAY,KAAZ,CAAkB,GAAlB,EAAuB,MAAvB,GAAgC,CAAvC;AACA,EAHH,EAIG,OAJH,CAIW,UAAU,KAAV,EAAiB;AACzB,MAAI,OAAO,MAAM,IAAN,GAAa,KAAb,CAAmB,GAAnB,CAAX;AACA,oBAAkB,KAAK,CAAL,CAAlB,IAA8B,KAAK,MAAL,KAAgB,CAAhB,GAAoB,KAAK,CAAL,CAApB,GAA8B,MAAM,IAAN,GAAa,KAAb,CAAmB,KAAK,CAAL,EAAQ,MAAR,GAAiB,CAApC,CAA5D;AACA,EAPH;AAQA,QAAO,iBAAP;AACA","file":"commonkeys.js","sourcesContent":["let fs = require('fs'),\r\n\t\tprojectIds = ['insight', 'ufc', 'nflgp', 'nba', 'crtv', 'site_12'],\r\n\t\ttotalKeyValueInfo = {},\r\n\t\tcommonKeyValues = [];\r\n\r\ninit();\r\n\r\nfunction init()\r\n{\r\n\tstatisticalProjects(projectIds);\r\n\r\n\tcommonKeyValues = getCommonKeyValueArray();\r\n\tsaveDataToFile(fs, '\\\\app\\\\', 'test.properties', commonKeyValues);\r\n\t// saveDataToFile(fs, '\\\\app\\\\', 'common.properties', commonKeyValues);\r\n}\r\n\r\nfunction statisticalProjects(projectIds)\r\n{\r\n\tprojectIds.forEach(function (projectId) {\r\n\t\tlet projectKeyObject = getFileContentDirectory(fs, __dirname + '\\\\' + projectId + '\\\\', 'user.properties');\r\n\t\tObject.keys(projectKeyObject).forEach(function (keyItem) {\r\n\t\t\tif (totalKeyValueInfo.hasOwnProperty(keyItem))\r\n\t\t\t{\r\n\t\t\t\ttotalKeyValueInfo[keyItem]['count'] += 1;\r\n\t\t\t\ttotalKeyValueInfo[keyItem]['diff'] += (projectKeyObject[keyItem] === totalKeyValueInfo[keyItem].value ? 0 : 1);\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\ttotalKeyValueInfo[keyItem] = {\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tdiff: 0,\r\n\t\t\t\t\tkey: keyItem,\r\n\t\t\t\t\tvalue: projectKeyObject[keyItem],\r\n\t\t\t\t\tprojects: {}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\ttotalKeyValueInfo[keyItem]['projects'][projectId] = projectKeyObject[keyItem];\r\n\t\t});\r\n\t});\r\n}\r\n\r\nfunction getCommonKeyValueArray()\r\n{\r\n\tlet resultArray = [];\r\n\tObject.keys(totalKeyValueInfo)\r\n\t\t\t.filter(function (keyItem) {\r\n\t\t\t\treturn totalKeyValueInfo[keyItem]['count'] > 1;\r\n\t\t\t}).map(function (keyItem) {\r\n\t\tlet propertyItem = totalKeyValueInfo[keyItem];\r\n\r\n\t\tif (propertyItem['diff'] === 0)\r\n\t\t{\r\n\t\t\tresultArray[resultArray.length] = {\r\n\t\t\t\tkey: propertyItem.key,\r\n\t\t\t\tvalue: propertyItem.value\r\n\t\t\t};\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\t// Add null value item after diff > 1:\r\n\t\t\tresultArray[resultArray.length] = {\r\n\t\t\t\tkey: \"\",\r\n\t\t\t\tvalue: \"\"\r\n\t\t\t};\r\n\t\t\tObject.keys(propertyItem['projects'])\r\n\t\t\t\t\t.map(function (projectId) {\r\n\t\t\t\t\t\tresultArray[resultArray.length] = {\r\n\t\t\t\t\t\t\tkey: propertyItem.key,\r\n\t\t\t\t\t\t\tvalue: propertyItem['projects'][projectId]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t// Add null value item after diff > 1:\r\n\t\t\tresultArray[resultArray.length] = {\r\n\t\t\t\tkey: \"\",\r\n\t\t\t\tvalue: \"\"\r\n\t\t\t};\r\n\t\t}\r\n\t});\r\n\treturn resultArray;\r\n}\r\n\r\nfunction saveDataToFile(fs, dir, fileName, dataArray)\r\n{\r\n\tlet dataString = dataArray.map(function (dataItem) {\r\n\t\treturn getKeyValueStringFormat(dataItem.key, dataItem.value);\r\n\t}).join('');\r\n\twriteDataToFile(fs, __dirname + dir, fileName, dataString);\r\n}\r\n\r\nfunction getKeyValueStringFormat(keyItem, value)\r\n{\r\n\tif (keyItem === \"\" && value === \"\")\r\n\t{\r\n\t\treturn '\\n';\r\n\t}\r\n\treturn (keyItem + '=' + value + '\\n');\r\n}\r\n\r\nfunction writeDataToFile(fs, dir, fileName, data)\r\n{\r\n\tfs.writeFile(dir + fileName, data, function (err) {\r\n\t\tif (err)\r\n\t\t{\r\n\t\t\tconsole.log('Write File failed!');\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tconsole.log(dir + \" \" + fileName + \" stored ok!\");\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction getFileContentDirectory(fs, dir, fileName)\r\n{\r\n\tlet sourceString = fs.readFileSync(dir + fileName).toString(),\r\n\t\t\tfileContentObject = {};\r\n\tsourceString.split(/\\n/)\r\n\t\t\t.filter(function (item) {\r\n\t\t\t\treturn item.trim().split('=').length > 1;\r\n\t\t\t})\r\n\t\t\t.forEach(function (value) {\r\n\t\t\t\tlet line = value.trim().split('=');\r\n\t\t\t\tfileContentObject[line[0]] = (line.length === 2 ? line[1] : value.trim().slice(line[0].length + 1));\r\n\t\t\t});\r\n\treturn fileContentObject;\r\n}"]}